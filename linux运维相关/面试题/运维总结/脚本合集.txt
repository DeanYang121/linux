#!/bin/sh
if [ $# -ne 1]
then
   echo "USAGE:$0 CMD"
   exit 1
fi
for n in 8 9
do
  echo ========10.0.0.$n=========
  ssh oldboy888@10.0.0.$n $1 2>/dev/null 
done


sh view.sh uptime
sh view.sh "free -m"
**************************************************
#!/bin/sh
IP=$(ifconfig eth1|awk -F '[ :]' 'NR==2 {print $4}')
Path="/backup/$IP"
[! -d $Path] && mkdir $Path -p

#backup
tar zcf $Path/www_$(date +%F).tar.gz /var/html/www/ &&\
tar zcf $Path/conf_$(date +%F).tar.gz /var/spool/cron/root /etc/rc.local /etc/sysconfig/iptables /server/scripts &&\
tar zcf $Path/logs_$(date +%F).tar.gz /app/logs/ &&\
find /backup/ -type f -name "*$(date +%F).tar.gz" | xargs md5sum >>$Path/flag_$(date +%F)

#to bac server
rsync -avz /backup/ -type rsync_backup@10.0.0.8::backup --password-file=/etc/rsync.password

#del
find /backup -type f -name "*.tar.gz" -mtime +7|xagrs rm -f
****************************************************************************


定时更新服务器时间：

crontab -e
crontab -l

*/5 * * * * /usr/sbin/ntpdate time.nist.gov >/dev/null 2>&1
#######
00 01 * * * /bin/sh /server/scripts/bak.sh >/dev/null 2>&1


####################################################

#!/bin/sh
./etc/init.d/function
if [ $# -ne 2]
then 
   echo "USAGE:$0 LocalName RemoteDir"
   exit 1
fi
for n in 8 9 10
do
  scp -rp $1 oldboy888@10.0.0.$n:~ &>/dev/null &&\
  ssh -t oldboy888@10.0.0.$n sudo rsync $1 $2 &>/dev/null
  if [ $? -eq 0 ]
  then
    action "$1 to 10.$n is ok" /bin/true
  else
    action "$1 to 10.$n is fail" /bin/false
fi
done
    mail -s "$(date +%F_%T) fenfa hosts" 958672189@qq.com </var/log/fail.log
    >/var/log/ok.log
    >/var/log/fail.log
fi

########################################################
#!/bin/sh
find /backup -type f -name "flag_$(date +%F)" |xagrs md5sum -c |grep FAILED >/opt/mail_body_$(date +%F).txt
mail -s "$(date +%U%T) back" 958672189@qq.com </opt/mail_body_$(date +%F).txt
#########################################################

sh fenfa.sh hosts

#!/bin/sh
. /etc/init.d/functions

if [$# -ne 1]
   then
     echo "USAGE:$0 {FILENAME|DIRNAME}"
     exit 1
fi

for n in 8 9 10
do
  scp -P22 $1 oldgirl@10.0.0.$n:~ &>/dev/null
  if[ $? -eq 0 ]
    then
       action "fenfa $1 ok" /bin/true
  else
       action "fenfa $1 ok" /bin/true
  fi
done

#########################################
nfs 共享目录权限  /date 10.0.0.0/24(rw,sync,all_squash)




/etc/init.d/sendmail start 启动邮件服务

